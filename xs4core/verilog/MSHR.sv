// Generated by CIRCT firtool-1.62.0
// Standard header to adapt well known macros for register randomization.
`ifndef RANDOMIZE
  `ifdef RANDOMIZE_MEM_INIT
    `define RANDOMIZE
  `endif // RANDOMIZE_MEM_INIT
`endif // not def RANDOMIZE
`ifndef RANDOMIZE
  `ifdef RANDOMIZE_REG_INIT
    `define RANDOMIZE
  `endif // RANDOMIZE_REG_INIT
`endif // not def RANDOMIZE

// RANDOM may be set to an expression that produces a 32-bit random unsigned value.
`ifndef RANDOM
  `define RANDOM $random
`endif // not def RANDOM

// Users can define INIT_RANDOM as general code that gets injected into the
// initializer block for modules with registers.
`ifndef INIT_RANDOM
  `define INIT_RANDOM
`endif // not def INIT_RANDOM

// If using random initialization, you can also define RANDOMIZE_DELAY to
// customize the delay used, otherwise 0.002 is used.
`ifndef RANDOMIZE_DELAY
  `define RANDOMIZE_DELAY 0.002
`endif // not def RANDOMIZE_DELAY

// Define INIT_RANDOM_PROLOG_ for use in our modules below.
`ifndef INIT_RANDOM_PROLOG_
  `ifdef RANDOMIZE
    `ifdef VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM
    `else  // VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM #`RANDOMIZE_DELAY begin end
    `endif // VERILATOR
  `else  // RANDOMIZE
    `define INIT_RANDOM_PROLOG_
  `endif // RANDOMIZE
`endif // not def INIT_RANDOM_PROLOG_

// Include register initializers in init blocks unless synthesis is set
`ifndef SYNTHESIS
  `ifndef ENABLE_INITIAL_REG_
    `define ENABLE_INITIAL_REG_
  `endif // not def ENABLE_INITIAL_REG_
`endif // not def SYNTHESIS

// Include rmemory initializers in init blocks unless synthesis is set
`ifndef SYNTHESIS
  `ifndef ENABLE_INITIAL_MEM_
    `define ENABLE_INITIAL_MEM_
  `endif // not def ENABLE_INITIAL_MEM_
`endif // not def SYNTHESIS

module MSHR(
  input         clock,
  input         reset,
  input  [7:0]  io_id,
  output        io_status_valid,
  output [8:0]  io_status_bits_set,
  output [18:0] io_status_bits_reqTag,
  output [18:0] io_status_bits_metaTag,
  output        io_status_bits_needsRepl,
  output        io_status_bits_w_c_resp,
  output        io_msInfo_valid,
  output [2:0]  io_msInfo_bits_channel,
  output [8:0]  io_msInfo_bits_set,
  output [2:0]  io_msInfo_bits_way,
  output [18:0] io_msInfo_bits_reqTag,
  output        io_msInfo_bits_willFree,
  output        io_msInfo_bits_aliasTask,
  output        io_msInfo_bits_needRelease,
  output        io_msInfo_bits_blockRefill,
  output [18:0] io_msInfo_bits_metaTag,
  output [1:0]  io_msInfo_bits_metaState,
  output        io_msInfo_bits_dirHit,
  output        io_msInfo_bits_isAcqOrPrefetch,
  output        io_msInfo_bits_isPrefetch,
  output [2:0]  io_msInfo_bits_param,
  output        io_msInfo_bits_mergeA,
  output        io_msInfo_bits_w_grantfirst,
  output        io_msInfo_bits_s_refill,
  output        io_msInfo_bits_w_releaseack,
  output        io_msInfo_bits_w_replResp,
  output        io_msInfo_bits_w_rprobeacklast,
  input         io_alloc_valid,
  input         io_alloc_bits_dirResult_hit,
  input  [18:0] io_alloc_bits_dirResult_tag,
  input  [8:0]  io_alloc_bits_dirResult_set,
  input  [2:0]  io_alloc_bits_dirResult_way,
  input         io_alloc_bits_dirResult_meta_dirty,
  input  [1:0]  io_alloc_bits_dirResult_meta_state,
  input         io_alloc_bits_dirResult_meta_clients,
  input         io_alloc_bits_dirResult_meta_alias,
  input         io_alloc_bits_dirResult_meta_prefetch,
  input         io_alloc_bits_dirResult_meta_accessed,
  input         io_alloc_bits_state_s_acquire,
  input         io_alloc_bits_state_s_rprobe,
  input         io_alloc_bits_state_s_pprobe,
  input         io_alloc_bits_state_s_probeack,
  input         io_alloc_bits_state_s_refill,
  input         io_alloc_bits_state_w_rprobeackfirst,
  input         io_alloc_bits_state_w_rprobeacklast,
  input         io_alloc_bits_state_w_pprobeackfirst,
  input         io_alloc_bits_state_w_pprobeacklast,
  input         io_alloc_bits_state_w_pprobeack,
  input         io_alloc_bits_state_w_grantfirst,
  input         io_alloc_bits_state_w_grantlast,
  input         io_alloc_bits_state_w_grant,
  input         io_alloc_bits_state_w_replResp,
  input  [2:0]  io_alloc_bits_task_channel,
  input  [8:0]  io_alloc_bits_task_set,
  input  [18:0] io_alloc_bits_task_tag,
  input  [5:0]  io_alloc_bits_task_off,
  input         io_alloc_bits_task_alias,
  input  [32:0] io_alloc_bits_task_vaddr,
  input         io_alloc_bits_task_isKeyword,
  input  [2:0]  io_alloc_bits_task_opcode,
  input  [2:0]  io_alloc_bits_task_param,
  input  [2:0]  io_alloc_bits_task_size,
  input  [6:0]  io_alloc_bits_task_sourceId,
  input         io_alloc_bits_task_needProbeAckData,
  input         io_alloc_bits_task_aliasTask,
  input         io_alloc_bits_task_fromL2pft,
  input  [3:0]  io_alloc_bits_task_reqSource,
  input         io_tasks_source_a_ready,
  output        io_tasks_source_a_valid,
  output [18:0] io_tasks_source_a_bits_tag,
  output [8:0]  io_tasks_source_a_bits_set,
  output [5:0]  io_tasks_source_a_bits_off,
  output [2:0]  io_tasks_source_a_bits_opcode,
  output [1:0]  io_tasks_source_a_bits_param,
  output [2:0]  io_tasks_source_a_bits_size,
  output [7:0]  io_tasks_source_a_bits_source,
  output [3:0]  io_tasks_source_a_bits_reqSource,
  input         io_tasks_source_b_ready,
  output        io_tasks_source_b_valid,
  output [18:0] io_tasks_source_b_bits_tag,
  output [8:0]  io_tasks_source_b_bits_set,
  output [1:0]  io_tasks_source_b_bits_param,
  output        io_tasks_source_b_bits_alias,
  input         io_tasks_mainpipe_ready,
  output        io_tasks_mainpipe_valid,
  output [2:0]  io_tasks_mainpipe_bits_channel,
  output [8:0]  io_tasks_mainpipe_bits_set,
  output [18:0] io_tasks_mainpipe_bits_tag,
  output [5:0]  io_tasks_mainpipe_bits_off,
  output        io_tasks_mainpipe_bits_alias,
  output [32:0] io_tasks_mainpipe_bits_vaddr,
  output        io_tasks_mainpipe_bits_isKeyword,
  output [2:0]  io_tasks_mainpipe_bits_opcode,
  output [2:0]  io_tasks_mainpipe_bits_param,
  output [6:0]  io_tasks_mainpipe_bits_sourceId,
  output [7:0]  io_tasks_mainpipe_bits_mshrId,
  output        io_tasks_mainpipe_bits_aliasTask,
  output        io_tasks_mainpipe_bits_useProbeData,
  output        io_tasks_mainpipe_bits_mshrRetry,
  output        io_tasks_mainpipe_bits_fromL2pft,
  output        io_tasks_mainpipe_bits_dirty,
  output [2:0]  io_tasks_mainpipe_bits_way,
  output        io_tasks_mainpipe_bits_meta_dirty,
  output [1:0]  io_tasks_mainpipe_bits_meta_state,
  output        io_tasks_mainpipe_bits_meta_clients,
  output        io_tasks_mainpipe_bits_meta_alias,
  output        io_tasks_mainpipe_bits_meta_prefetch,
  output [2:0]  io_tasks_mainpipe_bits_meta_prefetchSrc,
  output        io_tasks_mainpipe_bits_meta_accessed,
  output        io_tasks_mainpipe_bits_metaWen,
  output        io_tasks_mainpipe_bits_tagWen,
  output        io_tasks_mainpipe_bits_dsWen,
  output        io_tasks_mainpipe_bits_replTask,
  output [3:0]  io_tasks_mainpipe_bits_reqSource,
  output        io_tasks_mainpipe_bits_mergeA,
  output [5:0]  io_tasks_mainpipe_bits_aMergeTask_off,
  output        io_tasks_mainpipe_bits_aMergeTask_alias,
  output [32:0] io_tasks_mainpipe_bits_aMergeTask_vaddr,
  output        io_tasks_mainpipe_bits_aMergeTask_isKeyword,
  output [2:0]  io_tasks_mainpipe_bits_aMergeTask_opcode,
  output [2:0]  io_tasks_mainpipe_bits_aMergeTask_param,
  output [6:0]  io_tasks_mainpipe_bits_aMergeTask_sourceId,
  output        io_tasks_mainpipe_bits_aMergeTask_meta_dirty,
  output [1:0]  io_tasks_mainpipe_bits_aMergeTask_meta_state,
  output        io_tasks_mainpipe_bits_aMergeTask_meta_clients,
  output        io_tasks_mainpipe_bits_aMergeTask_meta_alias,
  output        io_tasks_mainpipe_bits_aMergeTask_meta_accessed,
  input         io_resps_sink_c_valid,
  input  [2:0]  io_resps_sink_c_bits_opcode,
  input  [2:0]  io_resps_sink_c_bits_param,
  input         io_resps_sink_c_bits_last,
  input         io_resps_sink_d_valid,
  input  [2:0]  io_resps_sink_d_bits_opcode,
  input  [2:0]  io_resps_sink_d_bits_param,
  input         io_resps_sink_d_bits_last,
  input         io_resps_sink_d_bits_dirty,
  input  [8:0]  io_nestedwb_set,
  input  [18:0] io_nestedwb_tag,
  input         io_nestedwb_c_set_dirty,
  output        io_nestedwbData,
  input         io_aMergeTask_valid,
  input  [5:0]  io_aMergeTask_bits_off,
  input         io_aMergeTask_bits_alias,
  input  [32:0] io_aMergeTask_bits_vaddr,
  input         io_aMergeTask_bits_isKeyword,
  input  [2:0]  io_aMergeTask_bits_opcode,
  input  [2:0]  io_aMergeTask_bits_param,
  input  [6:0]  io_aMergeTask_bits_sourceId,
  input         io_replResp_valid,
  input  [18:0] io_replResp_bits_tag,
  input  [2:0]  io_replResp_bits_way,
  input         io_replResp_bits_meta_dirty,
  input  [1:0]  io_replResp_bits_meta_state,
  input         io_replResp_bits_meta_clients,
  input         io_replResp_bits_meta_alias,
  input         io_replResp_bits_meta_prefetch,
  input         io_replResp_bits_meta_accessed,
  input         io_replResp_bits_retry
);

  wire [7:0][2:0] _GEN = '{3'h4, 3'h5, 3'h2, 3'h1, 3'h1, 3'h1, 3'h0, 3'h0};
  reg             gotT;
  reg             gotDirty;
  reg             gotGrantData;
  reg             probeDirty;
  reg             probeGotN;
  reg             req_valid;
  reg  [2:0]      req_channel;
  reg  [8:0]      req_set;
  reg  [18:0]     req_tag;
  reg  [5:0]      req_off;
  reg             req_alias;
  reg  [32:0]     req_vaddr;
  reg             req_isKeyword;
  reg  [2:0]      req_opcode;
  reg  [2:0]      req_param;
  reg  [2:0]      req_size;
  reg  [6:0]      req_sourceId;
  reg             req_needProbeAckData;
  reg             req_aliasTask;
  reg             req_fromL2pft;
  reg  [3:0]      req_reqSource;
  reg             dirResult_hit;
  reg  [18:0]     dirResult_tag;
  reg  [8:0]      dirResult_set;
  reg  [2:0]      dirResult_way;
  reg             dirResult_meta_dirty;
  reg  [1:0]      dirResult_meta_state;
  reg             dirResult_meta_clients;
  reg             dirResult_meta_alias;
  reg             dirResult_meta_prefetch;
  reg             dirResult_meta_accessed;
  reg             state_s_acquire;
  reg             state_s_rprobe;
  reg             state_s_pprobe;
  reg             state_s_release;
  reg             state_s_probeack;
  reg             state_s_refill;
  reg             state_s_retry;
  reg             state_w_rprobeackfirst;
  reg             state_w_rprobeacklast;
  reg             state_w_pprobeackfirst;
  reg             state_w_pprobeacklast;
  reg             state_w_pprobeack;
  reg             state_w_grantfirst;
  reg             state_w_grantlast;
  reg             state_w_grant;
  reg             state_w_releaseack;
  reg             state_w_replResp;
  wire            req_prefetch = req_opcode == 3'h5;
  wire            _req_acquire_T = req_opcode == 3'h6;
  wire            req_needT =
    ~(req_opcode[2]) | req_prefetch & req_param == 3'h1 | (_req_acquire_T | (&req_opcode))
    & (|req_param);
  wire            req_acquire = _req_acquire_T & req_channel[0] | (&req_opcode);
  wire            req_get = req_opcode == 3'h4;
  wire            _b_task_io_tasks_source_b_bits_param_T_2 = dirResult_meta_state == 2'h2;
  wire            mp_grant_task_mp_grant_meta_entry_accessed = req_acquire | req_get;
  wire            req_promoteT =
    (mp_grant_task_mp_grant_meta_entry_accessed | req_prefetch)
    & (dirResult_hit & ~dirResult_meta_clients & (&dirResult_meta_state) | ~dirResult_hit
       & gotT | dirResult_hit & req_aliasTask
       & (_b_task_io_tasks_source_b_bits_param_T_2 | (&dirResult_meta_state)));
  wire            io_tasks_source_b_valid_0 = ~state_s_pprobe | ~state_s_rprobe;
  wire            mp_release_valid =
    ~state_s_release & state_w_rprobeacklast & state_w_grantlast & state_w_replResp;
  wire            mp_probeack_valid = ~state_s_probeack & state_w_pprobeacklast;
  wire            mp_grant_valid =
    ~state_s_refill & state_w_grantlast & state_w_rprobeacklast;
  wire [2:0]      _mp_probeack_task_mp_probeack_param_T_2 =
    {dirResult_meta_state[1], req_param[1:0]};
  wire            _mp_probeack_task_mp_probeack_dsWen_T = req_param != 3'h2;
  reg             mergeA;
  wire            _mp_grant_task_aliasFinal_T = req_get | req_prefetch;
  wire [2:0]      _GEN_0 = {2'h0, ~req_promoteT};
  wire            mp_grant_alias =
    _mp_grant_task_aliasFinal_T ? dirResult_meta_alias : req_alias;
  wire            _mp_grant_task_mp_grant_aMergeTask_meta_x8_T =
    dirResult_meta_dirty | probeDirty;
  reg  [5:0]      mp_grant_task_merge_task_r_off;
  reg             mp_grant_task_merge_task_r_alias;
  reg  [32:0]     mp_grant_task_merge_task_r_vaddr;
  reg             mp_grant_task_merge_task_r_isKeyword;
  reg  [2:0]      mp_grant_task_merge_task_r_opcode;
  reg  [2:0]      mp_grant_task_merge_task_r_param;
  reg  [6:0]      mp_grant_task_merge_task_r_sourceId;
  wire            mp_grant_aMergeTask_alias =
    io_aMergeTask_valid ? io_aMergeTask_bits_alias : mp_grant_task_merge_task_r_alias;
  wire [2:0]      mp_grant_task_merge_task_opcode =
    io_aMergeTask_valid ? io_aMergeTask_bits_opcode : mp_grant_task_merge_task_r_opcode;
  wire [2:0]      mp_grant_task_merge_task_param =
    io_aMergeTask_valid ? io_aMergeTask_bits_param : mp_grant_task_merge_task_r_param;
  wire            _GEN_1 = mp_grant_valid | ~mp_release_valid;
  wire            will_free =
    state_s_refill & state_s_probeack & state_s_release & state_w_rprobeacklast
    & state_w_pprobeacklast & state_w_grantlast & state_w_releaseack & state_w_replResp;
  reg             io_msInfo_bits_blockRefill_REG;
  reg             io_msInfo_bits_blockRefill_REG_1;
  reg             io_msInfo_bits_blockRefill_REG_2;
  wire            nestedwb_match =
    req_valid & (|dirResult_meta_state) & dirResult_set == io_nestedwb_set
    & dirResult_tag == io_nestedwb_tag & state_w_replResp;
  wire            _probe_ts_T = io_tasks_source_b_ready & io_tasks_source_b_valid_0;
  wire            _GEN_2 = io_tasks_mainpipe_ready & mp_grant_valid;
  wire            _GEN_3 = io_resps_sink_c_bits_opcode == 3'h5;
  wire            _GEN_4 =
    io_resps_sink_c_valid & (io_resps_sink_c_bits_opcode == 3'h4 | _GEN_3);
  wire            _GEN_5 = io_resps_sink_d_bits_opcode == 3'h5;
  wire            _GEN_6 = io_resps_sink_d_bits_opcode == 3'h4 | _GEN_5;
  wire            _GEN_7 =
    io_resps_sink_d_valid & (_GEN_6 | io_resps_sink_d_bits_opcode == 3'h0);
  wire            _GEN_8 = io_replResp_valid & io_replResp_bits_retry;
  wire            _GEN_9 = io_replResp_valid & ~io_replResp_bits_retry;
  wire            _GEN_10 = _GEN_9 & (|io_replResp_bits_meta_state);
  wire            _GEN_11 =
    _GEN_9 & (|io_replResp_bits_meta_state) & io_replResp_bits_meta_clients;
  always @(posedge clock or posedge reset) begin
    if (reset) begin
      gotT <= 1'h0;
      gotDirty <= 1'h0;
      gotGrantData <= 1'h0;
      probeDirty <= 1'h0;
      probeGotN <= 1'h0;
      req_valid <= 1'h0;
      req_channel <= 3'h0;
      req_set <= 9'h0;
      req_tag <= 19'h0;
      req_off <= 6'h0;
      req_alias <= 1'h0;
      req_vaddr <= 33'h0;
      req_isKeyword <= 1'h0;
      req_opcode <= 3'h0;
      req_param <= 3'h0;
      req_size <= 3'h0;
      req_sourceId <= 7'h0;
      req_needProbeAckData <= 1'h0;
      req_aliasTask <= 1'h0;
      req_fromL2pft <= 1'h0;
      req_reqSource <= 4'h0;
      dirResult_hit <= 1'h0;
      dirResult_tag <= 19'h0;
      dirResult_set <= 9'h0;
      dirResult_way <= 3'h0;
      dirResult_meta_dirty <= 1'h0;
      dirResult_meta_state <= 2'h0;
      dirResult_meta_clients <= 1'h0;
      dirResult_meta_alias <= 1'h0;
      dirResult_meta_prefetch <= 1'h0;
      dirResult_meta_accessed <= 1'h0;
      state_s_acquire <= 1'h1;
      state_s_rprobe <= 1'h1;
      state_s_pprobe <= 1'h1;
      state_s_release <= 1'h1;
      state_s_probeack <= 1'h1;
      state_s_refill <= 1'h1;
      state_s_retry <= 1'h1;
      state_w_rprobeackfirst <= 1'h1;
      state_w_rprobeacklast <= 1'h1;
      state_w_pprobeackfirst <= 1'h1;
      state_w_pprobeacklast <= 1'h1;
      state_w_pprobeack <= 1'h1;
      state_w_grantfirst <= 1'h1;
      state_w_grantlast <= 1'h1;
      state_w_grant <= 1'h1;
      state_w_releaseack <= 1'h1;
      state_w_replResp <= 1'h1;
      mergeA <= 1'h0;
      mp_grant_task_merge_task_r_off <= 6'h0;
      mp_grant_task_merge_task_r_alias <= 1'h0;
      mp_grant_task_merge_task_r_vaddr <= 33'h0;
      mp_grant_task_merge_task_r_isKeyword <= 1'h0;
      mp_grant_task_merge_task_r_opcode <= 3'h0;
      mp_grant_task_merge_task_r_param <= 3'h0;
      mp_grant_task_merge_task_r_sourceId <= 7'h0;
      io_msInfo_bits_blockRefill_REG <= 1'h0;
      io_msInfo_bits_blockRefill_REG_1 <= 1'h0;
      io_msInfo_bits_blockRefill_REG_2 <= 1'h0;
    end
    else begin
      if (io_resps_sink_d_valid & _GEN_6) begin
        gotT <= io_resps_sink_d_bits_param == 3'h0;
        gotDirty <= gotDirty | io_resps_sink_d_bits_dirty;
      end
      else begin
        gotT <= ~io_alloc_valid & gotT;
        gotDirty <= ~io_alloc_valid & gotDirty;
      end
      gotGrantData <= io_resps_sink_d_valid & _GEN_5 | ~io_alloc_valid & gotGrantData;
      probeDirty <= io_resps_sink_c_valid & _GEN_3 | ~io_alloc_valid & probeDirty;
      probeGotN <=
        io_resps_sink_c_valid
        & (io_resps_sink_c_bits_param == 3'h1 | io_resps_sink_c_bits_param == 3'h2
           | io_resps_sink_c_bits_param == 3'h5) | ~io_alloc_valid & probeGotN;
      req_valid <= ~(will_free & req_valid) & (io_alloc_valid | req_valid);
      if (io_alloc_valid) begin
        req_channel <= io_alloc_bits_task_channel;
        req_set <= io_alloc_bits_task_set;
        req_tag <= io_alloc_bits_task_tag;
        req_off <= io_alloc_bits_task_off;
        req_alias <= io_alloc_bits_task_alias;
        req_vaddr <= io_alloc_bits_task_vaddr;
        req_isKeyword <= io_alloc_bits_task_isKeyword;
        req_opcode <= io_alloc_bits_task_opcode;
        req_param <= io_alloc_bits_task_param;
        req_size <= io_alloc_bits_task_size;
        req_sourceId <= io_alloc_bits_task_sourceId;
        req_needProbeAckData <= io_alloc_bits_task_needProbeAckData;
        req_aliasTask <= io_alloc_bits_task_aliasTask;
        req_fromL2pft <= io_alloc_bits_task_fromL2pft;
        req_reqSource <= io_alloc_bits_task_reqSource;
        dirResult_hit <= io_alloc_bits_dirResult_hit;
        dirResult_set <= io_alloc_bits_dirResult_set;
      end
      if (_GEN_9) begin
        dirResult_tag <= io_replResp_bits_tag;
        dirResult_meta_state <= io_replResp_bits_meta_state;
        dirResult_meta_clients <= io_replResp_bits_meta_clients;
        dirResult_meta_alias <= io_replResp_bits_meta_alias;
        dirResult_meta_prefetch <= io_replResp_bits_meta_prefetch;
        dirResult_meta_accessed <= io_replResp_bits_meta_accessed;
      end
      else begin
        if (io_alloc_valid) begin
          dirResult_tag <= io_alloc_bits_dirResult_tag;
          dirResult_meta_clients <= io_alloc_bits_dirResult_meta_clients;
          dirResult_meta_alias <= io_alloc_bits_dirResult_meta_alias;
          dirResult_meta_prefetch <= io_alloc_bits_dirResult_meta_prefetch;
          dirResult_meta_accessed <= io_alloc_bits_dirResult_meta_accessed;
        end
        if (~io_tasks_mainpipe_ready | mp_grant_valid | ~mp_release_valid) begin
          if (io_alloc_valid)
            dirResult_meta_state <= io_alloc_bits_dirResult_meta_state;
        end
        else
          dirResult_meta_state <= 2'h0;
      end
      if (_GEN_9 | _GEN_8)
        dirResult_way <= io_replResp_bits_way;
      else if (io_alloc_valid)
        dirResult_way <= io_alloc_bits_dirResult_way;
      dirResult_meta_dirty <=
        nestedwb_match & io_nestedwb_c_set_dirty
        | (_GEN_9
             ? io_replResp_bits_meta_dirty
             : io_alloc_valid
                 ? io_alloc_bits_dirResult_meta_dirty
                 : dirResult_meta_dirty);
      state_s_acquire <=
        io_tasks_source_a_ready & ~state_s_acquire
        | (io_alloc_valid ? io_alloc_bits_state_s_acquire : state_s_acquire);
      state_s_rprobe <=
        ~_GEN_11
        & (_probe_ts_T
           | (io_alloc_valid ? io_alloc_bits_state_s_rprobe : state_s_rprobe));
      state_s_pprobe <=
        _probe_ts_T | (io_alloc_valid ? io_alloc_bits_state_s_pprobe : state_s_pprobe);
      state_s_release <=
        ~_GEN_10
        & (~io_tasks_mainpipe_ready | mp_grant_valid
             ? io_alloc_valid | state_s_release
             : mp_release_valid | io_alloc_valid | state_s_release);
      state_s_probeack <=
        io_tasks_mainpipe_ready & ~(mp_grant_valid | mp_release_valid) & mp_probeack_valid
        | (io_alloc_valid ? io_alloc_bits_state_s_probeack : state_s_probeack);
      state_s_refill <=
        ~_GEN_8
        & (_GEN_2 | (io_alloc_valid ? io_alloc_bits_state_s_refill : state_s_refill));
      state_s_retry <= ~_GEN_8 & (_GEN_2 | io_alloc_valid | state_s_retry);
      state_w_rprobeackfirst <=
        ~_GEN_11
        & (_GEN_4
           | (io_alloc_valid
                ? io_alloc_bits_state_w_rprobeackfirst
                : state_w_rprobeackfirst));
      state_w_rprobeacklast <=
        ~_GEN_11
        & (_GEN_4
             ? state_w_rprobeacklast | io_resps_sink_c_bits_last
             : io_alloc_valid
                 ? io_alloc_bits_state_w_rprobeacklast
                 : state_w_rprobeacklast);
      state_w_pprobeackfirst <=
        _GEN_4
        | (io_alloc_valid
             ? io_alloc_bits_state_w_pprobeackfirst
             : state_w_pprobeackfirst);
      if (_GEN_4) begin
        state_w_pprobeacklast <= state_w_pprobeacklast | io_resps_sink_c_bits_last;
        state_w_pprobeack <= state_w_pprobeack | ~(|req_off) | io_resps_sink_c_bits_last;
      end
      else if (io_alloc_valid) begin
        state_w_pprobeacklast <= io_alloc_bits_state_w_pprobeacklast;
        state_w_pprobeack <= io_alloc_bits_state_w_pprobeack;
      end
      state_w_grantfirst <=
        _GEN_7 | (io_alloc_valid ? io_alloc_bits_state_w_grantfirst : state_w_grantfirst);
      if (_GEN_7) begin
        state_w_grantlast <= io_resps_sink_d_bits_last;
        state_w_grant <= ~(|req_off) | io_resps_sink_d_bits_last;
      end
      else if (io_alloc_valid) begin
        state_w_grantlast <= io_alloc_bits_state_w_grantlast;
        state_w_grant <= io_alloc_bits_state_w_grant;
      end
      state_w_releaseack <=
        ~_GEN_10
        & (io_resps_sink_d_valid & io_resps_sink_d_bits_opcode == 3'h6 | io_alloc_valid
           | state_w_releaseack);
      state_w_replResp <=
        _GEN_9 | (io_alloc_valid ? io_alloc_bits_state_w_replResp : state_w_replResp);
      mergeA <= io_aMergeTask_valid | ~io_alloc_valid & mergeA;
      if (io_aMergeTask_valid) begin
        mp_grant_task_merge_task_r_off <= io_aMergeTask_bits_off;
        mp_grant_task_merge_task_r_alias <= io_aMergeTask_bits_alias;
        mp_grant_task_merge_task_r_vaddr <= io_aMergeTask_bits_vaddr;
        mp_grant_task_merge_task_r_isKeyword <= io_aMergeTask_bits_isKeyword;
        mp_grant_task_merge_task_r_opcode <= io_aMergeTask_bits_opcode;
        mp_grant_task_merge_task_r_param <= io_aMergeTask_bits_param;
        mp_grant_task_merge_task_r_sourceId <= io_aMergeTask_bits_sourceId;
      end
      io_msInfo_bits_blockRefill_REG <= ~state_s_release;
      io_msInfo_bits_blockRefill_REG_1 <= ~state_s_release;
      io_msInfo_bits_blockRefill_REG_2 <= io_msInfo_bits_blockRefill_REG_1;
    end
  end // always @(posedge, posedge)
  `ifdef ENABLE_INITIAL_REG_
    `ifdef FIRRTL_BEFORE_INITIAL
      `FIRRTL_BEFORE_INITIAL
    `endif // FIRRTL_BEFORE_INITIAL
    logic [31:0] _RANDOM[0:17];
    initial begin
      `ifdef INIT_RANDOM_PROLOG_
        `INIT_RANDOM_PROLOG_
      `endif // INIT_RANDOM_PROLOG_
      `ifdef RANDOMIZE_REG_INIT
        for (logic [4:0] i = 5'h0; i < 5'h12; i += 5'h1) begin
          _RANDOM[i] = `RANDOM;
        end
        gotT = _RANDOM[5'h0][0];
        gotDirty = _RANDOM[5'h0][1];
        gotGrantData = _RANDOM[5'h0][2];
        probeDirty = _RANDOM[5'h0][3];
        probeGotN = _RANDOM[5'h0][4];
        req_valid = _RANDOM[5'h2][5];
        req_channel = _RANDOM[5'h2][8:6];
        req_set = _RANDOM[5'h2][20:12];
        req_tag = {_RANDOM[5'h2][31:21], _RANDOM[5'h3][7:0]};
        req_off = _RANDOM[5'h3][13:8];
        req_alias = _RANDOM[5'h3][14];
        req_vaddr = {_RANDOM[5'h3][31:15], _RANDOM[5'h4][15:0]};
        req_isKeyword = _RANDOM[5'h4][16];
        req_opcode = _RANDOM[5'h4][19:17];
        req_param = _RANDOM[5'h4][22:20];
        req_size = _RANDOM[5'h4][25:23];
        req_sourceId = {_RANDOM[5'h4][31:26], _RANDOM[5'h5][0]};
        req_needProbeAckData = _RANDOM[5'h5][3];
        req_aliasTask = _RANDOM[5'h5][13];
        req_fromL2pft = _RANDOM[5'h5][16];
        req_reqSource = _RANDOM[5'h6][15:12];
        dirResult_hit = _RANDOM[5'h8][27];
        dirResult_tag = {_RANDOM[5'h8][31:28], _RANDOM[5'h9][14:0]};
        dirResult_set = _RANDOM[5'h9][23:15];
        dirResult_way = _RANDOM[5'h9][26:24];
        dirResult_meta_dirty = _RANDOM[5'h9][27];
        dirResult_meta_state = _RANDOM[5'h9][29:28];
        dirResult_meta_clients = _RANDOM[5'h9][30];
        dirResult_meta_alias = _RANDOM[5'h9][31];
        dirResult_meta_prefetch = _RANDOM[5'hA][0];
        dirResult_meta_accessed = _RANDOM[5'hA][4];
        state_s_acquire = _RANDOM[5'hA][17];
        state_s_rprobe = _RANDOM[5'hA][18];
        state_s_pprobe = _RANDOM[5'hA][19];
        state_s_release = _RANDOM[5'hA][20];
        state_s_probeack = _RANDOM[5'hA][21];
        state_s_refill = _RANDOM[5'hA][22];
        state_s_retry = _RANDOM[5'hA][23];
        state_w_rprobeackfirst = _RANDOM[5'hA][24];
        state_w_rprobeacklast = _RANDOM[5'hA][25];
        state_w_pprobeackfirst = _RANDOM[5'hA][26];
        state_w_pprobeacklast = _RANDOM[5'hA][27];
        state_w_pprobeack = _RANDOM[5'hA][28];
        state_w_grantfirst = _RANDOM[5'hA][29];
        state_w_grantlast = _RANDOM[5'hA][30];
        state_w_grant = _RANDOM[5'hA][31];
        state_w_releaseack = _RANDOM[5'hB][0];
        state_w_replResp = _RANDOM[5'hB][1];
        mergeA = _RANDOM[5'hB][2];
        mp_grant_task_merge_task_r_off = _RANDOM[5'hC][10:5];
        mp_grant_task_merge_task_r_alias = _RANDOM[5'hC][11];
        mp_grant_task_merge_task_r_vaddr = {_RANDOM[5'hC][31:12], _RANDOM[5'hD][12:0]};
        mp_grant_task_merge_task_r_isKeyword = _RANDOM[5'hD][13];
        mp_grant_task_merge_task_r_opcode = _RANDOM[5'hD][16:14];
        mp_grant_task_merge_task_r_param = _RANDOM[5'hD][19:17];
        mp_grant_task_merge_task_r_sourceId = _RANDOM[5'hD][29:23];
        io_msInfo_bits_blockRefill_REG = _RANDOM[5'h11][24];
        io_msInfo_bits_blockRefill_REG_1 = _RANDOM[5'h11][25];
        io_msInfo_bits_blockRefill_REG_2 = _RANDOM[5'h11][26];
      `endif // RANDOMIZE_REG_INIT
      if (reset) begin
        gotT = 1'h0;
        gotDirty = 1'h0;
        gotGrantData = 1'h0;
        probeDirty = 1'h0;
        probeGotN = 1'h0;
        req_valid = 1'h0;
        req_channel = 3'h0;
        req_set = 9'h0;
        req_tag = 19'h0;
        req_off = 6'h0;
        req_alias = 1'h0;
        req_vaddr = 33'h0;
        req_isKeyword = 1'h0;
        req_opcode = 3'h0;
        req_param = 3'h0;
        req_size = 3'h0;
        req_sourceId = 7'h0;
        req_needProbeAckData = 1'h0;
        req_aliasTask = 1'h0;
        req_fromL2pft = 1'h0;
        req_reqSource = 4'h0;
        dirResult_hit = 1'h0;
        dirResult_tag = 19'h0;
        dirResult_set = 9'h0;
        dirResult_way = 3'h0;
        dirResult_meta_dirty = 1'h0;
        dirResult_meta_state = 2'h0;
        dirResult_meta_clients = 1'h0;
        dirResult_meta_alias = 1'h0;
        dirResult_meta_prefetch = 1'h0;
        dirResult_meta_accessed = 1'h0;
        state_s_acquire = 1'h1;
        state_s_rprobe = 1'h1;
        state_s_pprobe = 1'h1;
        state_s_release = 1'h1;
        state_s_probeack = 1'h1;
        state_s_refill = 1'h1;
        state_s_retry = 1'h1;
        state_w_rprobeackfirst = 1'h1;
        state_w_rprobeacklast = 1'h1;
        state_w_pprobeackfirst = 1'h1;
        state_w_pprobeacklast = 1'h1;
        state_w_pprobeack = 1'h1;
        state_w_grantfirst = 1'h1;
        state_w_grantlast = 1'h1;
        state_w_grant = 1'h1;
        state_w_releaseack = 1'h1;
        state_w_replResp = 1'h1;
        mergeA = 1'h0;
        mp_grant_task_merge_task_r_off = 6'h0;
        mp_grant_task_merge_task_r_alias = 1'h0;
        mp_grant_task_merge_task_r_vaddr = 33'h0;
        mp_grant_task_merge_task_r_isKeyword = 1'h0;
        mp_grant_task_merge_task_r_opcode = 3'h0;
        mp_grant_task_merge_task_r_param = 3'h0;
        mp_grant_task_merge_task_r_sourceId = 7'h0;
        io_msInfo_bits_blockRefill_REG = 1'h0;
        io_msInfo_bits_blockRefill_REG_1 = 1'h0;
        io_msInfo_bits_blockRefill_REG_2 = 1'h0;
      end
    end // initial
    `ifdef FIRRTL_AFTER_INITIAL
      `FIRRTL_AFTER_INITIAL
    `endif // FIRRTL_AFTER_INITIAL
  `endif // ENABLE_INITIAL_REG_
  assign io_status_valid = req_valid;
  assign io_status_bits_set = req_set;
  assign io_status_bits_reqTag = req_tag;
  assign io_status_bits_metaTag = dirResult_tag;
  assign io_status_bits_needsRepl = ~state_s_release;
  assign io_status_bits_w_c_resp =
    ~state_w_rprobeacklast | ~state_w_pprobeacklast | ~state_w_pprobeack;
  assign io_msInfo_valid = req_valid;
  assign io_msInfo_bits_channel = req_channel;
  assign io_msInfo_bits_set = req_set;
  assign io_msInfo_bits_way = dirResult_way;
  assign io_msInfo_bits_reqTag = req_tag;
  assign io_msInfo_bits_willFree = will_free;
  assign io_msInfo_bits_aliasTask = req_aliasTask;
  assign io_msInfo_bits_needRelease = ~state_w_releaseack;
  assign io_msInfo_bits_blockRefill =
    ~state_s_release | io_msInfo_bits_blockRefill_REG | io_msInfo_bits_blockRefill_REG_2;
  assign io_msInfo_bits_metaTag = dirResult_tag;
  assign io_msInfo_bits_metaState = dirResult_meta_state;
  assign io_msInfo_bits_dirHit = dirResult_hit;
  assign io_msInfo_bits_isAcqOrPrefetch = req_acquire | req_prefetch;
  assign io_msInfo_bits_isPrefetch = req_prefetch;
  assign io_msInfo_bits_param = req_param;
  assign io_msInfo_bits_mergeA = mergeA;
  assign io_msInfo_bits_w_grantfirst = state_w_grantfirst;
  assign io_msInfo_bits_s_refill = state_s_refill;
  assign io_msInfo_bits_w_releaseack = state_w_releaseack;
  assign io_msInfo_bits_w_replResp = state_w_replResp;
  assign io_msInfo_bits_w_rprobeacklast = state_w_rprobeacklast;
  assign io_tasks_source_a_valid = ~state_s_acquire;
  assign io_tasks_source_a_bits_tag = req_tag;
  assign io_tasks_source_a_bits_set = req_set;
  assign io_tasks_source_a_bits_off = req_off;
  assign io_tasks_source_a_bits_opcode =
    (&req_opcode) & dirResult_hit ? req_opcode : 3'h6;
  assign io_tasks_source_a_bits_param = req_needT ? (dirResult_hit ? 2'h2 : 2'h1) : 2'h0;
  assign io_tasks_source_a_bits_size = req_size;
  assign io_tasks_source_a_bits_source = io_id;
  assign io_tasks_source_a_bits_reqSource = req_reqSource;
  assign io_tasks_source_b_valid = io_tasks_source_b_valid_0;
  assign io_tasks_source_b_bits_tag = dirResult_tag;
  assign io_tasks_source_b_bits_set = dirResult_set;
  assign io_tasks_source_b_bits_param =
    state_s_pprobe
      ? (req_get & dirResult_hit & _b_task_io_tasks_source_b_bits_param_T_2 ? 2'h1 : 2'h2)
      : req_param[1:0];
  assign io_tasks_source_b_bits_alias = dirResult_meta_alias;
  assign io_tasks_mainpipe_valid = mp_release_valid | mp_probeack_valid | mp_grant_valid;
  assign io_tasks_mainpipe_bits_channel = req_channel;
  assign io_tasks_mainpipe_bits_set = req_set;
  assign io_tasks_mainpipe_bits_tag = _GEN_1 ? req_tag : dirResult_tag;
  assign io_tasks_mainpipe_bits_off = _GEN_1 ? req_off : 6'h0;
  assign io_tasks_mainpipe_bits_alias = mp_grant_valid & mp_grant_alias;
  assign io_tasks_mainpipe_bits_vaddr = req_vaddr;
  assign io_tasks_mainpipe_bits_isKeyword = req_isKeyword;
  assign io_tasks_mainpipe_bits_opcode =
    mp_grant_valid
      ? _GEN[req_opcode]
      : mp_release_valid
          ? 3'h7
          : {2'h2,
             dirResult_meta_dirty & dirResult_meta_state[1] | probeDirty
               | req_needProbeAckData};
  assign io_tasks_mainpipe_bits_param =
    mp_grant_valid
      ? (_mp_grant_task_aliasFinal_T | req_param == 3'h1 | req_param == 3'h2
           ? 3'h0
           : req_param == 3'h0 ? _GEN_0 : req_param)
      : mp_release_valid
          ? (dirResult_meta_state[1] ? 3'h1 : 3'h2)
          : {1'h0,
             _mp_probeack_task_mp_probeack_param_T_2 == 3'h2,
             _mp_probeack_task_mp_probeack_param_T_2 == 3'h6};
  assign io_tasks_mainpipe_bits_sourceId = mp_grant_valid ? req_sourceId : 7'h0;
  assign io_tasks_mainpipe_bits_mshrId = io_id;
  assign io_tasks_mainpipe_bits_aliasTask = mp_grant_valid & req_aliasTask;
  assign io_tasks_mainpipe_bits_useProbeData =
    mp_grant_valid
      ? dirResult_hit & req_get | req_aliasTask
        & ~(dirResult_meta_state == 2'h1 & req_needT)
      : ~mp_release_valid;
  assign io_tasks_mainpipe_bits_mshrRetry = mp_grant_valid & ~state_s_retry;
  assign io_tasks_mainpipe_bits_fromL2pft = mp_grant_valid & req_fromL2pft;
  assign io_tasks_mainpipe_bits_dirty =
    ~mp_grant_valid
    & (mp_release_valid
         ? dirResult_meta_dirty & (|dirResult_meta_state) | probeDirty
         : dirResult_meta_dirty & (|dirResult_meta_state) | probeDirty);
  assign io_tasks_mainpipe_bits_way = dirResult_way;
  assign io_tasks_mainpipe_bits_meta_dirty =
    mp_grant_valid
    & (gotDirty | dirResult_hit & _mp_grant_task_mp_grant_aMergeTask_meta_x8_T);
  assign io_tasks_mainpipe_bits_meta_state =
    mp_grant_valid
      ? (req_get
           ? {dirResult_hit ? dirResult_meta_state[1] : req_promoteT, 1'h1}
           : req_promoteT | req_needT ? {1'h1, req_prefetch} : 2'h1)
      : mp_release_valid | req_param == 3'h2
          ? 2'h0
          : req_param == 3'h1 ? 2'h1 : dirResult_meta_state;
  assign io_tasks_mainpipe_bits_meta_clients =
    mp_grant_valid
      ? (req_prefetch
           ? dirResult_hit & dirResult_meta_clients
           : ~(req_get & (~dirResult_hit | ~dirResult_meta_clients | probeGotN)))
      : ~mp_release_valid & ~probeGotN;
  assign io_tasks_mainpipe_bits_meta_alias =
    mp_grant_valid ? mp_grant_alias : ~mp_release_valid & dirResult_meta_alias;
  assign io_tasks_mainpipe_bits_meta_prefetch =
    mp_grant_valid
      ? req_prefetch | dirResult_hit & dirResult_meta_prefetch
      : ~mp_release_valid & _mp_probeack_task_mp_probeack_dsWen_T
        & dirResult_meta_prefetch;
  assign io_tasks_mainpipe_bits_meta_prefetchSrc =
    mp_grant_valid
      ? (req_reqSource == 4'h8
           ? 3'h2
           : req_reqSource == 4'h9
               ? 3'h3
               : req_reqSource == 4'hA
                   ? 3'h1
                   : req_reqSource == 4'hD
                       ? 3'h6
                       : req_reqSource == 4'hB
                           ? 3'h4
                           : req_reqSource == 4'hC ? 3'h5 : 3'h0)
      : 3'h0;
  assign io_tasks_mainpipe_bits_meta_accessed =
    mp_grant_valid
      ? mp_grant_task_mp_grant_meta_entry_accessed
      : ~mp_release_valid & _mp_probeack_task_mp_probeack_dsWen_T
        & dirResult_meta_accessed;
  assign io_tasks_mainpipe_bits_metaWen = mp_grant_valid | ~mp_release_valid;
  assign io_tasks_mainpipe_bits_tagWen = mp_grant_valid & ~dirResult_hit;
  assign io_tasks_mainpipe_bits_dsWen =
    mp_grant_valid
      ? gotGrantData | probeDirty & (req_get | req_aliasTask)
      : mp_release_valid | _mp_probeack_task_mp_probeack_dsWen_T & probeDirty;
  assign io_tasks_mainpipe_bits_replTask =
    mp_grant_valid ? ~dirResult_hit : mp_release_valid;
  assign io_tasks_mainpipe_bits_reqSource = req_reqSource;
  assign io_tasks_mainpipe_bits_mergeA = mp_grant_valid & (mergeA | io_aMergeTask_valid);
  assign io_tasks_mainpipe_bits_aMergeTask_off =
    mp_grant_valid
      ? (io_aMergeTask_valid ? io_aMergeTask_bits_off : mp_grant_task_merge_task_r_off)
      : 6'h0;
  assign io_tasks_mainpipe_bits_aMergeTask_alias =
    mp_grant_valid & mp_grant_aMergeTask_alias;
  assign io_tasks_mainpipe_bits_aMergeTask_vaddr =
    mp_grant_valid
      ? (io_aMergeTask_valid
           ? io_aMergeTask_bits_vaddr
           : mp_grant_task_merge_task_r_vaddr)
      : 33'h0;
  assign io_tasks_mainpipe_bits_aMergeTask_isKeyword =
    mp_grant_valid
    & (io_aMergeTask_valid
         ? io_aMergeTask_bits_isKeyword
         : mp_grant_task_merge_task_r_isKeyword);
  assign io_tasks_mainpipe_bits_aMergeTask_opcode =
    mp_grant_valid ? _GEN[mp_grant_task_merge_task_opcode] : 3'h0;
  assign io_tasks_mainpipe_bits_aMergeTask_param =
    ~mp_grant_valid | mp_grant_task_merge_task_param == 3'h1
    | mp_grant_task_merge_task_param == 3'h2
      ? 3'h0
      : mp_grant_task_merge_task_param == 3'h0 ? _GEN_0 : mp_grant_task_merge_task_param;
  assign io_tasks_mainpipe_bits_aMergeTask_sourceId =
    mp_grant_valid
      ? (io_aMergeTask_valid
           ? io_aMergeTask_bits_sourceId
           : mp_grant_task_merge_task_r_sourceId)
      : 7'h0;
  assign io_tasks_mainpipe_bits_aMergeTask_meta_dirty =
    mp_grant_valid
    & (gotDirty | dirResult_hit & _mp_grant_task_mp_grant_aMergeTask_meta_x8_T);
  assign io_tasks_mainpipe_bits_aMergeTask_meta_state =
    mp_grant_valid
      ? (req_promoteT | ~(mp_grant_task_merge_task_opcode[2])
         | mp_grant_task_merge_task_opcode == 3'h5
         & mp_grant_task_merge_task_param == 3'h1
         | (mp_grant_task_merge_task_opcode == 3'h6 | (&mp_grant_task_merge_task_opcode))
         & (|mp_grant_task_merge_task_param)
           ? 2'h2
           : 2'h1)
      : 2'h0;
  assign io_tasks_mainpipe_bits_aMergeTask_meta_clients = mp_grant_valid;
  assign io_tasks_mainpipe_bits_aMergeTask_meta_alias =
    mp_grant_valid & mp_grant_aMergeTask_alias;
  assign io_tasks_mainpipe_bits_aMergeTask_meta_accessed = mp_grant_valid;
  assign io_nestedwbData = nestedwb_match & io_nestedwb_c_set_dirty;
endmodule

